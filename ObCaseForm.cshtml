
@{
    ViewBag.Title = "ObCaseForm";
    //Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Obstetrical Patient</h2>

<div data-ng-controller="obstetricsController as obstetrics" id="obstetricsCtrl">
    <div id="formContainer" class="block push-bit form-horizontal form-bordered form-control-borderless">
        <form class="form-horizontal form-bordered form-control-borderless" id="obForm" name="obstetrics.obForm" ng-submit="obstetrics.onSubmitForm()" novalidate>
            <div class="form-group">
                <div class="col-xs-6">
                    Patient ID
                    <div class="input-group">
                        <input type="text"
                               placeholder=""
                               style="width: 150px;"
                               id="patient"
                               name="patient"
                               ng-model="obstetrics.newData.patient"
                               class="form-control ng-class:{'has-error': obstetrics.obForm.patient.$touched && !obstetrics.obForm.patient.$valid}"
                               ng-minlength="5"
                               required>
                        @*<div class="help-block" ng-messages="obstetrics.obForm.patient.$error" ng-if="obstetrics.obForm.patient.$touched">
                                <span ng-message="minlength">Please enter patient ID</span>
                            </div>*@

                        @*<div role="alert" class="help-inline error" style="color:red">
                                <span class="error" ng-show="obstetrics.showFormErrors && obstetrics.obForm.patient.$pristine">Please enter patient ID</span>
                                <span class="error" ng-show="obstetrics.showFormErrors && obstetrics.obForm.patient.$error.minlength">Patient ID is required to be at least 5 characters</span>
                            </div>*@
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="col-xs-6">
                    Age
                    <div class="input-group">
                        <input type="number"
                               placeholder=""
                               style="width: 75px;"
                               id="age"
                               name="age"
                               ng-model="obstetrics.newData.age"
                               class="form-control ng-class:{'error': obstetrics.showFormErrors && !obstetrics.obForm.age.$valid}"
                               min="13" max="100"
                               required>
                        @*<div role="alert" class="help-inline error" style="color:red">
                                <span class="error" ng-show="obstetrics.showFormErrors && obstetrics.obForm.age.$error.required">Please enter patient's age</span>
                                <span class="error" ng-show="obstetrics.showFormErrors && obstetrics.obForm.age.$error.number">Not a valid age</span>
                            </div>*@
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="col-xs-6">
                    Gravity
                    <div class="input-group">
                        <input type="number"
                               placeholder=""
                               style="width: 75px;"
                               id="gravity"
                               name="gravity"
                               ng-model="obstetrics.newData.gravity"
                               class="form-control ng-class:{'error': obstetrics.showFormErrors && !obstetrics.obForm.gravity.$valid}"
                               min="1"
                               integer>
                        @*<div role="alert" class="help-inline error" style="color:red">
                                <span class="error" ng-show="obstetrics.showFormErrors && obstetrics.obForm.gravity.$error.integer">Please enter gravity</span>
                                <span class="error" ng-show="obstetrics.showFormErrors && obstetrics.obForm.gravity.$error.min">Patient must have at least 1 pregnancy</span>
                            </div>*@
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="col-xs-6">
                    Parity
                    <div class="input-group">
                        <input type="number"
                               placeholder=""
                               style="width: 75px;"
                               id="term"
                               name="term"
                               ng-model="obstetrics.newData.parity"
                               class="form-control ng-class:{'error': obstetrics.showFormErrors && !obstetrics.obForm.parity.$valid}"
                               min="0"
                               integer>
                        @*<div role="alert" class="help-inline error" style="color:red">
                                <span class="error" ng-show="obstetrics.showFormErrors && obstetrics.obForm.parity.$error.integer">Enter valid # of term deliveries</span>
                            </div>*@

                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="col-xs-6">
                    Complications
                    <div class="input-group">
                        Antepartum
                        <select class="form-control" name="compSelect" ng-model="obstetrics.newData.compSelect" required>
                            <option value=""></option>
                            <option value="option-1">Preconception evaluation, prenatal and genetic diagnoses</option>
                            <option value="option-2">Ultrasonography</option>
                            <option value="option-3">Premature labor</option>
                            <option value="option-4">Premature rupture of fetal membranes at term</option>
                            <option value="option-5">Preterm premature rupture of fetal membranes</option>
                            <option value="option-6">Cerclage</option>
                            <option value="option-7">Preterm delivery (before 37 weeks gestation)</option>
                            <option value="option-8">Late preterm (37 weeks 0 days to 38 weeks 6 days gestation)</option>
                            <option value="option-9">Post term pregnancy and delivery</option>
                            <option value="option-10">Induction and augmentation abnormalities (e.g. variable or late deceleration, absent of poor variability)</option>
                            <option value="option-11">Labor abnormalities (including dystocia)</option>
                            <option value="option-12">Fetal heart rate abnormalities (e.g. variable or late deceleration, absent or poor variability, tachycardia, bradycardia)</option>
                            <option value="option-13">Breech and other fetal malpresentations</option>
                            <option value="option-14">Cord problems (e.g. prolapsed cord, cord entanglement)</option>
                            <option value="option-15">Operative vaginal delivery (e.g. vacuum, forceps)</option>
                            <option value="option-16">Obstetrial hemmorage (e.g. antepartum, intrapartum, postpartum)</option>
                            <option value="option-17">Obstetrical vaginal lacerations (e.g. 3rd and 4th degree lacerations cervical laceration)</option>
                            <option value="option-18">Vaginal or perineal hematoma</option>
                            <option value="option-19">Primary cesarean delivery</option>
                            <option value="option-20">Repeat cesarean delivery</option>
                            <option value="option-21">Vaginal birth after cesarean delivery</option>
                            <option value="option-22">Cesarean hysterectomy</option>
                            <option value="option-23">Complications of cesarean delivery (e.g. hemorrhage, wound infection, disruption or hematoma)</option>
                            <option value="option-24">Complications of OB anesthesia</option>
                            <option value="option-25">Intrapartum or intra-amniotic infection (e.g. amnionitis, chorioamnionitis)</option>
                            <option value="option-26">Puerperal infection (e.g. post cesarean endometritis)</option>
                            <option value="option-27">Second trimester spontaneous abortion</option>
                            <option value="option-28">Third trimester fetal loss</option>
                            <option value="option-29">Hypertensive disorders of pregnancy (chronic hypertension, preeclampsia, eclampsia)</option>
                            <option value="option-30">Cardiovascular or pulmonary disease complicating pregnancy</option>
                            <option value="option-31">Renal of neruological disease complicating pregnancy</option>
                            <option value="option-32">Hematological or endocrine diseases complicating pregnancy</option>
                            <option value="option-33">Autoimmune disorders of pregnancy</option>
                            <option value="option-34">Infectious diesases (HIV, Group A streptococcus, etc.)</option>
                            <option value="option-35">Psychiatric disease complicating pregnancy</option>
                            <option value="option-36">Pregnancies complicated by human immunodeficiency virus infection (HIV)</option>
                            <option value="option-37">Abnormal fetal growth</option>
                            <option value="option-38">Pregnancies complicated by fetal abnormalities</option>
                            <option value="option-39">Placental abnormalities</option>
                            <option value="option-40">Thromboembolic complications</option>
                            <option value="option-41">Trauma in pregnancy (e.g. automobile accidents)</option>
                            <option value="option-99">Uncategorized (cases in this category do not count toward the required 20 cases)</option>
                        </select>
                        @*<div role="alert" class="help-inline error" style="color:red">
                                <span class="error" ng-show="obstetrics.showFormErrors && obstetrics.obForm.compSelect.$error.required">Please enter category</span>
                            </div>*@
                    </div>
                    <div class="input-group">
                        Delivery/Postpartum
                        <select class="form-control" name="compSelect" ng-model="obstetrics.newData.compSelect" required>
                            <option value=""></option>
                            <option value="option-1">Preconception evaluation, prenatal and genetic diagnoses</option>
                            <option value="option-2">Ultrasonography</option>
                            <option value="option-3">Premature labor</option>
                            <option value="option-4">Premature rupture of fetal membranes at term</option>
                            <option value="option-5">Preterm premature rupture of fetal membranes</option>
                            <option value="option-6">Cerclage</option>
                            <option value="option-7">Preterm delivery (before 37 weeks gestation)</option>
                            <option value="option-8">Late preterm (37 weeks 0 days to 38 weeks 6 days gestation)</option>
                            <option value="option-9">Post term pregnancy and delivery</option>
                            <option value="option-10">Induction and augmentation abnormalities (e.g. variable or late deceleration, absent of poor variability)</option>
                            <option value="option-11">Labor abnormalities (including dystocia)</option>
                            <option value="option-12">Fetal heart rate abnormalities (e.g. variable or late deceleration, absent or poor variability, tachycardia, bradycardia)</option>
                            <option value="option-13">Breech and other fetal malpresentations</option>
                            <option value="option-14">Cord problems (e.g. prolapsed cord, cord entanglement)</option>
                            <option value="option-15">Operative vaginal delivery (e.g. vacuum, forceps)</option>
                            <option value="option-16">Obstetrial hemmorage (e.g. antepartum, intrapartum, postpartum)</option>
                            <option value="option-17">Obstetrical vaginal lacerations (e.g. 3rd and 4th degree lacerations cervical laceration)</option>
                            <option value="option-18">Vaginal or perineal hematoma</option>
                            <option value="option-19">Primary cesarean delivery</option>
                            <option value="option-20">Repeat cesarean delivery</option>
                            <option value="option-21">Vaginal birth after cesarean delivery</option>
                            <option value="option-22">Cesarean hysterectomy</option>
                            <option value="option-23">Complications of cesarean delivery (e.g. hemorrhage, wound infection, disruption or hematoma)</option>
                            <option value="option-24">Complications of OB anesthesia</option>
                            <option value="option-25">Intrapartum or intra-amniotic infection (e.g. amnionitis, chorioamnionitis)</option>
                            <option value="option-26">Puerperal infection (e.g. post cesarean endometritis)</option>
                            <option value="option-27">Second trimester spontaneous abortion</option>
                            <option value="option-28">Third trimester fetal loss</option>
                            <option value="option-29">Hypertensive disorders of pregnancy (chronic hypertension, preeclampsia, eclampsia)</option>
                            <option value="option-30">Cardiovascular or pulmonary disease complicating pregnancy</option>
                            <option value="option-31">Renal of neruological disease complicating pregnancy</option>
                            <option value="option-32">Hematological or endocrine diseases complicating pregnancy</option>
                            <option value="option-33">Autoimmune disorders of pregnancy</option>
                            <option value="option-34">Infectious diesases (HIV, Group A streptococcus, etc.)</option>
                            <option value="option-35">Psychiatric disease complicating pregnancy</option>
                            <option value="option-36">Pregnancies complicated by human immunodeficiency virus infection (HIV)</option>
                            <option value="option-37">Abnormal fetal growth</option>
                            <option value="option-38">Pregnancies complicated by fetal abnormalities</option>
                            <option value="option-39">Placental abnormalities</option>
                            <option value="option-40">Thromboembolic complications</option>
                            <option value="option-41">Trauma in pregnancy (e.g. automobile accidents)</option>
                            <option value="option-99">Uncategorized (cases in this category do not count toward the required 20 cases)</option>
                        </select>
                        @*<div role="alert" class="help-inline error" style="color:red">
                                <span class="error" ng-show="obstetrics.showFormErrors && obstetrics.obForm.compSelect.$error.required">Please enter category</span>
                            </div>*@
                    </div>

                </div>
            </div>
            <div class="form-group">
                <div class="col-xs-6">
                    Operative Procedures And/Or Treatment
                    <div class="input-group">
                        <input type="text"
                               placeholder=""
                               id="outcome"
                               name="outcome"
                               ng-model="obstetrics.newData.outcome"
                               class="form-control ng-class:{'error': obstetrics.showFormErrors && !obstetrics.obForm.outcome.$valid}"
                               ng-minlength="5"
                               required>
                        @*<div role="alert" class="help-inline error" style="color:red">
                                <span class="error" ng-show="obstetrics.showFormErrors && obstetrics.obForm.outcome.$error.required">Please enter outcome</span>
                                <span class="error" ng-show="obstetrics.showFormErrors && obstetrics.obForm.outcome.$error.minlength">Please enter at least 5 characters</span>
                            </div>*@
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="col-xs-6">
                    <div class="input-group">
                        Birth Weight<br>
                        <div class="left">
                            <input type="number"
                                   style="width: 80px;"
                                   id="grams"
                                   name="grams"
                                   ng-model="obstetrics.newData.grams"
                                   class="form-control ng-class:{'error': obstetrics.showFormErrors && !obstetrics.obForm.grams.$valid}"
                                   min="500" max="6000"
                                   required> grams
                        </div>
                        @*<div role="alert" class="help-inline error" style="color:red">
                                <span class="error" ng-show="obstetrics.showFormErrors && obstetrics.obForm.grams.$error.required || obstetrics.obForm.ounces.$error.required">Please enter baby's birthweight</span>
                                <span class="error" ng-show="obstetrics.showFormErrors && obstetrics.obForm.grams.$error.number || obstetrics.obForm.ounces.$error.number">Please enter valid numbers</span>
                            </div>*@
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="col-xs-6">
                    <div class="form-bordered">
                        APGAR Score<br>
                        <div class="ng-class:{'error': obstetrics.showFormErrors && !obstetrics.obForm.scoreOne.$valid}">
                            After 1 min
                            <input type="radio" name="scoreOne" ng-model="obstetrics.newData.scoreOne" value="1" ng-required="!obstetrics.newData.scoreOne"> 1
                            <input type="radio" name="scoreOne" ng-model="obstetrics.newData.scoreOne" value="2" ng-required="!obstetrics.newData.scoreOne"> 2
                            <input type="radio" name="scoreOne" ng-model="obstetrics.newData.scoreOne" value="3" ng-required="!obstetrics.newData.scoreOne"> 3
                            <input type="radio" name="scoreOne" ng-model="obstetrics.newData.scoreOne" value="4" ng-required="!obstetrics.newData.scoreOne"> 4
                            <input type="radio" name="scoreOne" ng-model="obstetrics.newData.scoreOne" value="5" ng-required="!obstetrics.newData.scoreOne"> 5
                            <input type="radio" name="scoreOne" ng-model="obstetrics.newData.scoreOne" value="6" ng-required="!obstetrics.newData.scoreOne"> 6
                            <input type="radio" name="scoreOne" ng-model="obstetrics.newData.scoreOne" value="7" ng-required="!obstetrics.newData.scoreOne"> 7
                            <input type="radio" name="scoreOne" ng-model="obstetrics.newData.scoreOne" value="8" ng-required="!obstetrics.newData.scoreOne"> 8
                            <input type="radio" name="scoreOne" ng-model="obstetrics.newData.scoreOne" value="9" ng-required="!obstetrics.newData.scoreOne"> 9
                            <input type="radio" name="scoreOne" ng-model="obstetrics.newData.scoreOne" value="10" ng-required="!obstetrics.newData.scoreOne"> 10
                            @*<div role="alert" class="help-inline error" style="color:red">
                                    <span class="error" ng-show="obstetrics.showFormErrors && obstetrics.obForm.scoreOne.$error.required">Please enter score</span>
                                </div>*@
                        </div>
                        <div class="ng-class:{'error': obstetrics.showFormErrors && !obstetrics.obForm.scoreFive.$valid}">
                            After 5 min
                            <input type="radio" name="scoreFive" ng-model="obstetrics.newData.scoreFive" value="1" ng-required="!obstetrics.newData.scoreFive"> 1
                            <input type="radio" name="scoreFive" ng-model="obstetrics.newData.scoreFive" value="2" ng-required="!obstetrics.newData.scoreFive"> 2
                            <input type="radio" name="scoreFive" ng-model="obstetrics.newData.scoreFive" value="3" ng-required="!obstetrics.newData.scoreFive"> 3
                            <input type="radio" name="scoreFive" ng-model="obstetrics.newData.scoreFive" value="4" ng-required="!obstetrics.newData.scoreFive"> 4
                            <input type="radio" name="scoreFive" ng-model="obstetrics.newData.scoreFive" value="5" ng-required="!obstetrics.newData.scoreFive"> 5
                            <input type="radio" name="scoreFive" ng-model="obstetrics.newData.scoreFive" value="6" ng-required="!obstetrics.newData.scoreFive"> 6
                            <input type="radio" name="scoreFive" ng-model="obstetrics.newData.scoreFive" value="7" ng-required="!obstetrics.newData.scoreFive"> 7
                            <input type="radio" name="scoreFive" ng-model="obstetrics.newData.scoreFive" value="8" ng-required="!obstetrics.newData.scoreFive"> 8
                            <input type="radio" name="scoreFive" ng-model="obstetrics.newData.scoreFive" value="9" ng-required="!obstetrics.newData.scoreFive"> 9
                            <input type="radio" name="scoreFive" ng-model="obstetrics.newData.scoreFive" value="10" ng-required="!obstetrics.newData.scoreFive"> 10
                            @*<div role="alert" class="help-inline error" style="color:red">
                                    <span class="error" ng-show="obstetrics.showFormErrors && obstetrics.obForm.scoreFive.$error.required">Please enter score</span>
                                </div>*@
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="col-xs-6">
                    <div class="input-group">
                        Length of stay<br>
                        <input type="number"
                               style="width: 80px;"
                               id="stay"
                               name="stay"
                               ng-model="obstetrics.newData.stay"
                               class="form-control ng-class:{'error': obstetrics.showFormErrors && !obstetrics.obForm.stay.$valid}"
                               min="0"
                               required> days
                        @*<div role="alert" class="help-inline error" style="color:red">
                                <span class="error" ng-show="obstetrics.showFormErrors && obstetrics.obForm.stay.$error.required">Please enter length of stay</span>
                                <span class="error" ng-show="obstetrics.showFormErrors && obstetrics.obForm.stay.$error.number">Please enter valid numbers</span>
                            </div>*@
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="col-xs-6 text-left">
                    <button type="button" id="cmdRegister" class="btn btn-sm btn-primary"><i class="fa fa-plus"></i> Submit Notes</button>
                </div>
            </div>

        </form>
    </div>

</div>

@section Scripts{

@*<script src="~/Scripts/sabio.js"></script>
<script src="~/Scripts/ng/angular.js"></script>
<script src="~/Scripts/ng/angular-animate.js"></script>
<script src="~/Scripts/ng/angular-sanitize.js"></script>
<script src="~/Scripts/bootstrap.js"></script>
<script src="~/Scripts/sabio.ng.app.js"></script>*@

<script src="~/Scripts/sabio.services.obstetrics.js"></script>

<script type="text/javascript">

    sabio.page.startUp = function () {
        sabio.page.userController = sabio.ng.getControllerInstance($("#obstetricsCtrl"));
    }

    sabio.services.obstetricsFactory = function ($baseService) {
        var aSabioServiceObject = sabio.services.obstetrics;
        var newService = $baseService.merge(true, {}, aSabioServiceObject, $baseService);
        return newService;
    }

    sabio.ng.addService(sabio.ng.app.module,
        "$obstetricsService",
        ["$baseService"],
        sabio.services.obstetricsFactory);

    sabio.page.obstetricsControllerFactory = function ($scope, $baseController, $obstetricsService) {

        var vm = this;

        $baseController.merge(vm, $baseController);

        vm.$obstetricsService = $obstetricsService;
        vm.$scope = $scope;

        vm.settings = _settings;
        vm.onSubmitForm = _onSubmitForm;

        vm.newData = null;
        vm.showFormErrors = false;

        vm.notify = vm.$obstetricsService.getNotifier($scope);

        render();

        function render() {
            vm.settings();
        };

        function _settings() {
            vm.showFormErrors = false;
        }

        function _onSubmitForm(evt) {
            vm.showFormErrors = true;

            evt.preventDefault();
            console.log("validating");
            if (vm.obForm.$valid) {
                console.log("form is valid");
                var form = vm.newData;
            } else {
                console.log("form is not valid");
            }
        }
    }

    sabio.ng.addController(sabio.ng.app.module,
        "obstetricsController",
        ['$scope', '$baseController', "$obstetricsService"],
        sabio.page.obstetricsControllerFactory);


</script>

}
